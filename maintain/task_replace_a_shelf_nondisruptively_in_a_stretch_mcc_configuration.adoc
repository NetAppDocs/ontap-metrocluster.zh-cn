---
permalink: maintain/task_replace_a_shelf_nondisruptively_in_a_stretch_mcc_configuration.html 
sidebar: sidebar 
keywords: metrocluster, maintain, service, replace, shelf, nondisruptively, stretch, configuration 
summary: 在使用已完全填充的磁盘架或磁盘架机箱的延伸型 MetroCluster 配置中，您可以更换磁盘架而不会造成中断，并可从要移除的磁盘架传输组件。 
---
= 在延伸型 MetroCluster 配置中无中断更换磁盘架
:icons: font
:imagesdir: ../media/


[role="lead"]
在使用已完全填充的磁盘架或磁盘架机箱的延伸型 MetroCluster 配置中，您可以更换磁盘架而不会造成中断，并可从要移除的磁盘架传输组件。

要安装的磁盘架型号必须满足中指定的存储系统要求 link:https://hwu.netapp.com["Hardware Universe"]，其中包括支持的磁盘架型号，支持的磁盘驱动器类型，堆栈中的最大磁盘架数量以及支持的 ONTAP 版本。

.步骤
. 正确接地。
. 确定包含要更换的磁盘架的环路中的磁盘的所有聚合和卷，并记下受影响的丛名称。
+
任一节点都可能包含受影响磁盘架环路中的磁盘以及主机聚合或主机卷。

. 根据您计划的更换情形，选择以下两个选项之一。
+
** 如果要更换完整的磁盘架，包括磁盘架机箱，磁盘和 I/O 模块（ IOM ），请按照下表所述执行相应的操作：
+
|===
| 场景 | 操作 


 a| 
* 受影响的丛包含受影响磁盘架中较少的磁盘。 *
 a| 
使用另一个磁盘架中的备用磁盘逐个更换受影响磁盘架上的磁盘。


NOTE: 完成磁盘更换后，您可以使丛脱机。



 a| 
* 受影响丛包含的磁盘数超过受影响磁盘架中的磁盘数。 *
 a| 
将丛移至脱机状态，然后删除该丛。



 a| 
* 受影响的丛具有受影响磁盘架中的任何磁盘。 *
 a| 
使丛脱机，但不要将其删除。

|===
** 如果您仅更换磁盘架机箱，而不更换其他组件，请执行以下步骤：
+
... 使受影响丛与托管它们的控制器脱机： + ` * 聚合脱机 *`
... 验证丛是否已脱机：
+
` * 聚合状态 -r*`





. 确定受影响磁盘架环路所连接的控制器 SAS 端口，并禁用两个站点控制器上的 SAS 端口：
+
` * 存储端口禁用 -node _node_name_ -port _sas_port_*`

+
受影响的磁盘架环路连接到两个站点。

. 等待 ONTAP 识别磁盘缺失。您可以使用以下命令验证磁盘是否缺失： ` * sysconfig -A*` 或 ` * sysconfig -r*` 。
. 关闭磁盘架上的电源开关。
. 从磁盘架拔下所有电源线。
. 记录拔下缆线的端口，以便以相同方式为新磁盘架布线。
. 拔下并拔下将磁盘架连接到其他磁盘架或存储系统的缆线。
. 从机架中卸下磁盘架。
+
为了减轻磁盘架重量并便于操作，请卸下电源和 IOM 。如果要安装磁盘架机箱，请同时卸下磁盘驱动器或托架。否则，请尽可能避免移除磁盘驱动器或托架，因为过度处理可能会导致发生原因内部驱动器损坏。

. 将替代磁盘架安装并固定到支架和机架上。
. 如果您安装了磁盘架机箱，请重新安装电源和 IOM 。
. 完全按照您卸下的磁盘架上的配置，将所有缆线连接到更换用的磁盘架端口，以重新配置磁盘架堆栈。
. 打开备用磁盘架的电源，等待磁盘驱动器旋转。
. 将磁盘架 ID 更改为从 0 到 98 的唯一 ID 。
. 启用先前禁用的任何 SAS 端口，然后等待 ONTAP 识别磁盘已插入。
+
您可以使用以下命令验证是否已插入磁盘： ` *sysconfig -A*` 或 ` *sysconfig -r*` 。

. 如果要更换整个磁盘架（磁盘架机箱，磁盘， IOM ），请执行以下步骤：
+

NOTE: 如果您仅更换磁盘架机箱，而不更换其他组件，请转至步骤 19 。

+
.. 使用 ` * storage disk option modify -autodassign*` 命令确定磁盘自动分配是否已启用（ on ）。
+
磁盘分配将自动进行。

.. 如果未启用磁盘自动分配，请手动分配磁盘所有权。


. 将丛移回联机状态： ` * aggregate online _plex name_*`
. 重新创建通过镜像聚合删除的任何丛。
. 在丛开始重新同步时监控它们：
+
` * 聚合状态 -r < 聚合名称 >*`

. 验证存储系统是否按预期运行：
+
` * 系统运行状况警报 show*`


